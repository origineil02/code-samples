<html>
  <link rel="stylesheet" type="text/css" href="http://mleibman.github.io/SlickGrid/slick.grid.css">
  <script src="http://code.jquery.com/jquery-2.1.1.min.js"></script>
  <script src="http://code.jquery.com/ui/1.11.0/jquery-ui.min.js"></script>

  <script src="http://mleibman.github.io/SlickGrid/slick.dataview.js"></script>
  <script src='http://mleibman.github.io/SlickGrid/lib/jquery.event.drag-2.2.js'></script>
  <script src='http://mleibman.github.io/SlickGrid/slick.core.js'></script>
  <script src='http://mleibman.github.io/SlickGrid/slick.grid.js'></script>
  <script src='http://mleibman.github.io/SlickGrid/slick.groupitemmetadataprovider.js'></script>

  <button id='group' type='button'>Group by State</button>
  <button id='clearGrouping' type='button'>Clear grouping</button>

  <div id="myGrid" style="width:600px;height:500px;"></div>

  <script>
    var dataView = new Slick.Data.DataView();
    $('#clearGrouping').click(function() {
      dataView.setGrouping([])
    })

    $("#group").click(function() {
      dataView.setGrouping({
        getter: "state",
        formatter: function(g) {
          return "" + g.value + " <span style='color:green'>(" + g.count + " items)</span>";
        },
        aggregateCollapsed: false,
        lazyTotalsCalculation: true
      });

      dataView.setAggregators([new Slick.Data.Aggregators.Sum("data")], true);
    });

    var columns = [
      {id: "column1", name: "State", field: "state", sortable: true},
      {id: "column2", name: "City", field: "city", sortable: true},
      {id: "column3", name: "Zip", field: "zip"}
    ];

    var options = {
      enableCellNavigation: true,
      editable: true,
      forceFitColumns: true,
      multiColumnSort: true
    };

    var grid = new Slick.Grid('#myGrid', dataView, columns, options);

    dataView.onRowCountChanged.subscribe(function(e, args) {
      grid.updateRowCount();
      grid.render();
    });

    dataView.onRowsChanged.subscribe(function(e, args) {
      grid.invalidateRows(args.rows);
      grid.render();
    });

    grid.onSort.subscribe(function(e, args) {

      console.log(args.multiColumnSort)
      console.log(args.sortCols)
      var comparer = function(a, b) {
        return (a[args.sortCols[0].field] > b[args.sortCols[0].field]) ? 1 : -1;
      }

      dataView.sort(comparer, args.sortAsc);
    });

    var data = [
      {state: 'CA', city: 'Los Angeles', zip: '90014'},
      {state: 'CA', city: 'Santa Monica', zip: '90401'},
      {state: 'NY', city: 'Manhattan', zip: '10001'}
    ]

    dataView.setItems(data, 'zip');

  </script>
</html>
